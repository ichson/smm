const fetch = require("node-fetch");
const { TypeError, Error } = require("../error");

module.exports = async(webhook, messageId) => {

    if(!messageId) throw new TypeError('INVALID_MESSAGEID', 'No message ID has been provided.');

    const exists = await fetch(`https://discord.com/api/v9/webhooks/${(await webhook).id}/${(await webhook).token}/messages/${messageId}`, {
        method: 'GET'
    })
    const jsonExists = await exists.json();
    if(jsonExists.code === 50035) throw new Error('INVALID_MESSAGEID', 'An message with the provided ID is not found.');

    fetch(`https://discord.com/api/v9/webhooks/${(await webhook).id}/${(await webhook).token}/messages/${messageId}`, {
        method: 'DELETE'
    })
    .catch(err => {
        if(err) throw new Error('UNEXPECTED_ERROR', err.message);
    });

};